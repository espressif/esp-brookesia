board: echoear_core_board_v1_2
chip: esp32s3
version: 1.0.0
# Devices Configuration for EchoEar Core Board V1.0
devices:
  # Audio Power Control after Audio init
  - name: audio_power
    type: power_ctrl
    sub_type: gpio
    peripherals:
    - name: gpio_power_audio
      active_level: 1

  # LCD and SDCard Power Control before LCD init
  - name: lcd_sdcard_power
    type: power_ctrl
    sub_type: gpio
    peripherals:
    - name: gpio_power_lcd_sdcard
      active_level: 0

  - name: lcd_brightness
    type: ledc_ctrl
    version: default
    config:
      default_percent: 0  # 0-100, default 0 percent
    peripherals:
      - name: ledc_backlight               # LEDC peripheral for GPIO 44

  - name: audio_dac
    chip: es8311
    type: audio_codec
    version: default
    power_ctrl_device: audio_power
    config:
      adc_enabled: false
      dac_enabled: true
      dac_max_channel: 1
      # DAC channel mask, 1-enable, 0-disable, layout: left,right
      dac_channel_mask: "1"            # Left, Right enable
      mclk_enabled: true

    # Power amplifier configuration
    peripherals:
      - name: gpio_pa_control
        gain: 6                          # dB
        active_level: 1                  # 0-low, 1-high

      # I2S interface configuration
      - name: i2s_audio_out
      # I2C interface configuration
      - name: i2c_master
        address: 0x30
        frequency: 400000                # Hz

  # Audio ADC Configuration (ES7210)
  - name: audio_adc
    chip: es7210
    type: audio_codec
    version: default
    power_ctrl_device: audio_power
    config:
      adc_enabled: true
      adc_max_channel: 4
      # The channel mask, 1-enable, 0-disable
      # e.g."0111", bit0: Mic0 enable, bit1: Mic1 enable, bit2: Mic2 enable, bit3: Mic3 enable, bit4: Mic4 disable
      adc_channel_mask: "0111"         # Mic0, Mic1, Mic2 enable
      adc_channel_labels: ['NA', 'RE', 'FR', 'FL'] # MSB ~ LSB
      adc_init_gain: 0                 # dB

    # I2S interface configuration
    peripherals:
      # I2S interface configuration
      - name: i2s_audio_in
      # I2C interface configuration
      - name: i2c_master
        address: 0x80
        frequency: 400000                # Hz

  - name: fs_sdcard
    type: fs_fat
    sub_type: sdmmc
    power_ctrl_device: lcd_sdcard_power
    version: default
    config:
      vfs_config:
        format_if_mount_failed: true
      sub_config:
        bus_width: 1                      # 1, 4, or 8 for slot 0; 1 or 4 for slot 1
        slot_flags: "SDMMC_SLOT_FLAG_INTERNAL_PULLUP" # SDMMC_SLOT_FLAG_INTERNAL_PULLUP, SDMMC_SLOT_FLAG_WP_ACTIVE_HIGH, SDMMC_SLOT_FLAG_UHS1
        pins:
          clk: 16                         # GPIO_NUM_16
          cmd: 38                         # GPIO_NUM_38
          d0: 17                          # GPIO_NUM_17

  # LCD Display Configuration
  - name: display_lcd
    chip: st77916
    type: display_lcd
    sub_type: spi
    power_ctrl_device: lcd_sdcard_power
    version: default
    dependencies:
      espressif/esp_lcd_st77916: "*"
    config:
      x_max: 360
      y_max: 360
      need_reset: false
      # esp_lcd_panel_io_spi_config_t fields
      io_spi_config:
        cs_gpio_num: 14                   # GPIO14 - LCD_CS (BSP_LCD_CS)
        dc_gpio_num: 45                   # GPIO45 - LCD_DC (BSP_LCD_DC)
        spi_mode: 0                       # Traditional SPI mode (0~3)
        lcd_cmd_bits: 32                   # Bit-width of LCD command
        flags:
          quad_mode: true                 # Quad mode (4 data lines) - ST77916 uses quad mode

      lcd_panel_config:
        reset_gpio_num: 47
        flags:
          reset_active_high: true        # Reset pin active level (default: false)
        # ST77916 specific configuration
        vendor_config: NULL

    peripherals:
    - name: spi_display                  # SPI peripheral for LCD communication

  # Touch Panel Configuration
  - name: lcd_touch
    chip: cst816s
    type: lcd_touch_i2c
    version: default
    dependencies:
      espressif/esp_lcd_touch_cst816s: "*"
    config:
      # esp_lcd_panel_io_i2c_config_t fields for touch communication
      io_i2c_config:
        dev_addr: 0x15                    # CST816S I2C address (different from default 0x5A)
        peripherals:
          - name: i2c_master                   # I2C peripheral for touch communication

      # esp_lcd_touch_config_t fields for touch configuration
      touch_config:
        x_max: 360                        # Maximum X coordinate (BSP_LCD_H_RES)
        y_max: 360                        # Maximum Y coordinate (BSP_LCD_V_RES)
        int_gpio_num: 10                  # Interrupt GPIO (BSP_LCD_TOUCH_INT)

  # LED GREEN
  - name: led_green
    type: gpio_ctrl
    version: default
    config:
      active_level: 0
      default_level: 1
    peripherals:
      - name: gpio_led_g
